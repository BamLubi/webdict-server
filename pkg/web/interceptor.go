package web

import (
	"github.com/gin-gonic/gin"
	"strings"
	"webdict-server/pkg/config"
)

// remoteAddr 获取客户端地址, 包括 ip 和 port
func remoteAddr(req *gin.Context) []string {
	var addr string

	addr = req.Request.RemoteAddr

	if addr == "" {
		addr = req.Request.Header.Get("ipv4") + ":0000"
	}

	if addr == "" {
		addr = req.Request.Header.Get("XForwardedFor") + ":0000"
	}

	if addr == "" {
		addr = req.Request.Header.Get("X-Forwarded-For") + ":0000"
	}

	if addr == "" {
		addr = req.Request.Header.Get("X-Real-Ip") + ":0000"
	}

	if addr == "" {
		addr = "127.0.0.1:0000"
	}

	return strings.Split(addr, ":")
}

func isAllowedHost(ip string) bool {
	var allowedHosts = [...]string{
		"127.0.0.1", "121.255.252.36", "121.255.252.37", "121.255.252.38", "121.255.252.39",
		"121.255.252.40", "121.255.252.41", "121.255.252.42", "121.255.252.43", "121.255.252.44",
		"121.255.252.45", "121.255.252.46", "121.255.252.47", "121.255.252.48", "121.255.252.49",
		"121.255.252.50", "121.255.252.51", "121.255.252.52", "121.255.252.53", "121.255.252.54",
		"121.255.252.55", "121.255.252.56", "121.255.252.57", "121.255.252.58", "121.255.252.59",
		"121.255.252.60", "121.255.252.61", "121.255.252.62", "121.255.252.63", "121.255.252.64",
		"121.255.252.65", "121.255.252.66", "121.255.252.67", "121.255.252.68", "121.255.252.69",
		"121.255.252.70", "121.255.252.71", "121.255.252.72", "121.255.252.73", "121.255.252.74",
		"121.255.252.75", "121.255.252.76", "121.255.252.77", "121.255.252.78", "121.255.252.79",
		"121.255.252.80", "121.255.252.81", "121.255.252.82", "121.255.252.83", "121.255.252.84",
		"121.255.252.85", "121.255.252.86", "121.255.252.87", "121.255.252.88", "121.255.252.89",
		"121.255.252.90", "121.255.252.91", "121.255.252.92", "121.255.252.93", "121.255.252.94",
		"121.255.252.95", "121.255.252.96", "121.255.252.97", "121.255.252.98", "121.255.252.99",
		"121.255.252.100", "121.255.252.101", "121.255.252.102", "121.255.252.103", "121.255.252.104",
		"121.255.252.105", "121.255.252.106", "121.255.252.107", "121.255.252.108", "121.255.252.109",
		"121.255.252.110", "121.255.252.111", "121.255.252.112", "121.255.252.113", "121.255.252.114",
		"121.255.252.115", "121.255.252.116", "121.255.252.117", "121.255.252.118", "121.255.252.119",
		"121.255.252.120", "121.255.252.121", "121.255.252.122", "121.255.252.123", "121.255.252.124",
		"121.255.252.125", "121.255.252.126", "121.255.252.127", "121.255.252.128", "121.255.252.129",
		"121.255.252.130", "121.255.252.131", "121.255.252.132", "121.255.252.133", "121.255.252.134",
		"121.255.252.135", "121.255.252.136", "121.255.252.137", "121.255.252.138", "121.255.252.139",
		"121.255.252.140", "121.255.252.141", "121.255.252.142", "121.255.252.143", "121.255.252.144",
		"121.255.252.145", "121.255.252.146", "121.255.252.147", "121.255.252.148", "121.255.252.149",
		"121.255.252.150", "121.255.252.151", "121.255.252.152", "121.255.252.153", "121.255.252.154",
		"121.255.252.155", "121.255.252.156", "121.255.252.157", "121.255.252.158", "121.255.252.159",
		"121.255.252.160", "121.255.252.161", "121.255.252.162", "121.255.252.163", "121.255.252.164",
		"121.255.252.165", "121.255.252.166", "121.255.252.167", "121.255.252.168", "121.255.252.169",
		"121.255.252.170", "121.255.252.171", "121.255.252.172", "121.255.252.173", "121.255.252.174",
		"121.255.252.175", "121.255.252.176", "121.255.252.177", "121.255.252.178", "121.255.252.179",
		"121.255.252.180", "121.255.252.181", "121.255.252.182", "121.255.252.183", "121.255.252.184",
		"121.255.252.185", "121.255.252.186", "121.255.252.187", "121.255.252.188", "121.255.252.189",
		"121.255.252.190", "121.255.252.191", "121.255.252.192", "121.255.252.193", "121.255.252.194",
		"121.255.252.195", "121.255.252.196", "121.255.252.197", "121.255.252.198", "121.255.252.199",
		"121.255.252.200", "121.255.252.201", "121.255.252.202", "121.255.252.203", "121.255.252.204",
		"121.255.252.205", "121.255.252.206", "121.255.252.207", "121.255.252.208", "121.255.252.209",
		"121.255.252.210", "121.255.252.211", "121.255.252.212", "121.255.252.213", "121.255.252.214",
		"121.255.252.215", "121.255.252.216", "121.255.252.217", "121.255.252.218", "121.255.252.219",
		"121.255.252.220", "121.255.252.221", "121.255.252.222", "121.255.252.223", "121.255.252.224",
		"121.255.252.225", "121.255.252.226", "121.255.252.227", "121.255.252.228", "121.255.252.229",
		"121.255.252.230", "121.255.252.231", "121.255.252.232", "121.255.252.233", "121.255.252.234",
		"121.255.252.235", "121.255.252.236", "121.255.252.237", "121.255.252.238", "121.255.252.239",
		"121.255.252.240", "121.255.252.241", "121.255.252.242", "121.255.252.243", "121.255.252.244",
		"121.255.252.245", "121.255.252.246", "121.255.252.247", "121.255.252.248", "121.255.252.249",
		"121.255.252.250", "121.255.252.251", "121.255.252.252", "121.255.252.253", "121.255.252.254",
		"121.255.252.255", "121.255.253.0", "121.255.253.1", "121.255.253.2", "121.255.253.3",
		"121.255.253.4", "121.255.253.5", "121.255.253.6", "121.255.253.7", "121.255.253.8",
		"121.255.253.9", "121.255.253.10", "121.255.253.11", "121.255.253.12", "121.255.253.13",
		"121.255.253.14", "121.255.253.15", "121.255.253.16", "121.255.253.17", "121.255.253.18",
		"121.255.253.19", "121.255.253.20", "121.255.253.21", "121.255.253.22", "121.255.253.23",
		"121.255.253.24", "121.255.253.25", "121.255.253.26", "121.255.253.27", "121.255.253.28",
		"121.255.253.29", "121.255.253.30", "121.255.253.31", "121.255.253.32", "121.255.253.33",
		"121.255.253.34", "121.255.253.35", "121.255.253.36", "121.255.253.37", "121.255.253.38",
		"121.255.253.39", "121.255.253.40", "121.255.253.41", "121.255.253.42", "121.255.253.43",
		"121.255.253.44", "121.255.253.45", "121.255.253.46", "121.255.253.47", "121.255.253.48",
		"121.255.253.49", "121.255.253.50", "121.255.253.51", "121.255.253.52", "121.255.253.53",
		"121.255.253.54", "121.255.253.55", "121.255.253.56", "121.255.253.57", "121.255.253.58",
		"121.255.253.59", "121.255.253.60", "121.255.253.61", "121.255.253.62", "121.255.253.63",
		"121.255.253.64", "121.255.253.65", "121.255.253.66", "121.255.253.67", "121.255.253.68",
		"121.255.253.69", "121.255.253.70", "121.255.253.71", "121.255.253.72", "121.255.253.73",
		"121.255.253.74", "121.255.253.75", "121.255.253.76", "121.255.253.77", "121.255.253.78",
		"121.255.253.79", "121.255.253.80", "121.255.253.81", "121.255.253.82", "121.255.253.83",
		"121.255.253.84", "121.255.253.85", "121.255.253.86", "121.255.253.87", "121.255.253.88",
		"121.255.253.89", "121.255.253.90", "121.255.253.91", "121.255.253.92", "121.255.253.93",
		"121.255.253.94", "121.255.253.95", "121.255.253.96", "121.255.253.97", "121.255.253.98",
		"121.255.253.99", "121.255.253.100", "121.255.253.101", "121.255.253.102", "121.255.253.103",
		"121.255.253.104", "121.255.253.105", "121.255.253.106", "121.255.253.107", "121.255.253.108",
		"121.255.253.109", "121.255.253.110", "121.255.253.111", "121.255.253.112", "121.255.253.113",
		"121.255.253.114", "121.255.253.115", "121.255.253.116", "121.255.253.117", "121.255.253.118",
		"121.255.253.119", "121.255.253.120", "121.255.253.121", "121.255.253.122", "121.255.253.123",
		"121.255.253.124", "121.255.253.125", "121.255.253.126", "121.255.253.127", "121.255.253.128",
		"121.255.253.129", "121.255.253.130", "121.255.253.131", "121.255.253.132", "121.255.253.133",
		"121.255.253.134", "121.255.253.135", "121.255.253.136", "121.255.253.137", "121.255.253.138",
		"121.255.253.139", "121.255.253.140", "121.255.253.141", "121.255.253.142", "121.255.253.143",
		"121.255.253.144", "121.255.253.145", "121.255.253.146", "121.255.253.147", "121.255.253.148",
		"121.255.253.149", "121.255.253.150", "121.255.253.151", "121.255.253.152", "121.255.253.153",
		"121.255.253.154", "121.255.253.155", "121.255.253.156", "121.255.253.157", "121.255.253.158",
		"121.255.253.159", "121.255.253.160", "121.255.253.161", "121.255.253.162", "121.255.253.163",
		"121.255.253.164", "121.255.253.165", "121.255.253.166", "121.255.253.167", "121.255.253.168",
		"121.255.253.169", "121.255.253.170", "121.255.253.171", "121.255.253.172", "121.255.253.173",
		"121.255.253.174", "121.255.253.175", "121.255.253.176", "121.255.253.177", "121.255.253.178",
		"121.255.253.179", "121.255.253.180", "121.255.253.181", "121.255.253.182", "121.255.253.183",
		"121.255.253.184", "121.255.253.185", "121.255.253.186", "121.255.253.187", "121.255.253.188",
		"121.255.253.189", "121.255.253.190", "121.255.253.191", "121.255.253.192", "121.255.253.193",
		"121.255.253.194", "121.255.253.195", "121.255.253.196", "121.255.253.197", "121.255.253.198",
		"121.255.253.199", "121.255.253.200", "121.255.253.201", "121.255.253.202", "121.255.253.203",
		"121.255.253.204", "121.255.253.205", "121.255.253.206", "121.255.253.207", "121.255.253.208",
		"121.255.253.209", "121.255.253.210", "121.255.253.211", "121.255.253.212", "121.255.253.213",
		"121.255.253.214", "121.255.253.215", "121.255.253.216", "121.255.253.217", "121.255.253.218",
		"121.255.253.219", "121.255.253.220", "121.255.253.221", "121.255.253.222", "121.255.253.223",
		"121.255.253.224", "121.255.253.225", "121.255.253.226", "121.255.253.227", "121.255.253.228",
		"121.255.253.229", "121.255.253.230", "121.255.253.231", "121.255.253.232", "121.255.253.233",
		"121.255.253.234", "121.255.253.235", "121.255.253.236", "121.255.253.237", "121.255.253.238",
		"121.255.253.239", "121.255.253.240", "121.255.253.241", "121.255.253.242", "121.255.253.243",
		"121.255.253.244", "121.255.253.245", "121.255.253.246", "121.255.253.247", "121.255.253.248",
		"121.255.253.249", "121.255.253.250", "121.255.253.251", "121.255.253.252", "121.255.253.253",
		"121.255.253.254", "121.255.253.255", "121.255.254.0", "121.255.254.1", "121.255.254.2",
		"121.255.254.3", "121.255.254.4", "121.255.254.5", "121.255.254.6", "121.255.254.7",
		"121.255.254.8", "121.255.254.9", "121.255.254.10", "121.255.254.11", "121.255.254.12",
		"121.255.254.13", "121.255.254.14", "121.255.254.15", "121.255.254.16", "121.255.254.17",
		"121.255.254.18", "121.255.254.19", "121.255.254.20", "121.255.254.21", "121.255.254.22",
		"121.255.254.23", "121.255.254.24", "121.255.254.25", "121.255.254.26", "121.255.254.27",
		"121.255.254.28", "121.255.254.29", "121.255.254.30", "121.255.254.31", "121.255.254.32",
		"121.255.254.33", "121.255.254.34", "121.255.254.35", "121.255.254.36", "121.255.254.37",
		"121.255.254.38", "121.255.254.39", "121.255.254.40", "121.255.254.41", "121.255.254.42",
		"121.255.254.43", "121.255.254.44", "121.255.254.45", "121.255.254.46", "121.255.254.47",
		"121.255.254.48", "121.255.254.49", "121.255.254.50", "121.255.254.51", "121.255.254.52",
		"121.255.254.53", "121.255.254.54", "121.255.254.55", "121.255.254.56", "121.255.254.57",
		"121.255.254.58", "121.255.254.59", "121.255.254.60", "121.255.254.61", "121.255.254.62",
		"121.255.254.63", "121.255.254.64", "121.255.254.65", "121.255.254.66", "121.255.254.67",
		"121.255.254.68", "121.255.254.69", "121.255.254.70", "121.255.254.71", "121.255.254.72",
		"121.255.254.73", "121.255.254.74", "121.255.254.75", "121.255.254.76", "121.255.254.77",
		"121.255.254.78", "121.255.254.79", "121.255.254.80", "121.255.254.81", "121.255.254.82",
		"121.255.254.83", "121.255.254.84", "121.255.254.85", "121.255.254.86", "121.255.254.87",
		"121.255.254.88", "121.255.254.89", "121.255.254.90", "121.255.254.91", "121.255.254.92",
		"121.255.254.93", "121.255.254.94", "121.255.254.95", "121.255.254.96", "121.255.254.97",
		"121.255.254.98", "121.255.254.99", "121.255.254.100", "121.255.254.101", "121.255.254.102",
		"121.255.254.103", "121.255.254.104", "121.255.254.105", "121.255.254.106", "121.255.254.107",
		"121.255.254.108", "121.255.254.109", "121.255.254.110", "121.255.254.111", "121.255.254.112",
		"121.255.254.113", "121.255.254.114", "121.255.254.115", "121.255.254.116", "121.255.254.117",
		"121.255.254.118", "121.255.254.119", "121.255.254.120", "121.255.254.121", "121.255.254.122",
		"121.255.254.123", "121.255.254.124", "121.255.254.125", "121.255.254.126", "121.255.254.127",
		"121.255.254.128", "121.255.254.129", "121.255.254.130", "121.255.254.131", "121.255.254.132",
		"121.255.254.133", "121.255.254.134", "121.255.254.135", "121.255.254.136", "121.255.254.137",
		"121.255.254.138", "121.255.254.139", "121.255.254.140", "121.255.254.141", "121.255.254.142",
		"121.255.254.143", "121.255.254.144", "121.255.254.145", "121.255.254.146", "121.255.254.147",
		"121.255.254.148", "121.255.254.149", "121.255.254.150", "121.255.254.151", "121.255.254.152",
		"121.255.254.153", "121.255.254.154", "121.255.254.155", "121.255.254.156", "121.255.254.157",
		"121.255.254.158", "121.255.254.159", "121.255.254.160", "121.255.254.161", "121.255.254.162",
		"121.255.254.163", "121.255.254.164", "121.255.254.165", "121.255.254.166", "121.255.254.167",
		"121.255.254.168", "121.255.254.169", "121.255.254.170", "121.255.254.171", "121.255.254.172",
		"121.255.254.173", "121.255.254.174", "121.255.254.175", "121.255.254.176", "121.255.254.177",
		"121.255.254.178", "121.255.254.179", "121.255.254.180", "121.255.254.181", "121.255.254.182",
		"121.255.254.183", "121.255.254.184", "121.255.254.185", "121.255.254.186", "121.255.254.187",
		"121.255.254.188", "121.255.254.189", "121.255.254.190", "121.255.254.191", "121.255.254.192",
		"121.255.254.193", "121.255.254.194", "121.255.254.195", "121.255.254.196", "121.255.254.197",
		"121.255.254.198", "121.255.254.199", "121.255.254.200", "121.255.254.201", "121.255.254.202",
		"121.255.254.203", "121.255.254.204", "121.255.254.205", "121.255.254.206", "121.255.254.207",
		"121.255.254.208", "121.255.254.209", "121.255.254.210", "121.255.254.211", "121.255.254.212",
		"121.255.254.213", "121.255.254.214", "121.255.254.215", "121.255.254.216", "121.255.254.217",
		"121.255.254.218", "121.255.254.219", "121.255.254.220", "121.255.254.221", "121.255.254.222",
		"121.255.254.223", "121.255.254.224", "121.255.254.225", "121.255.254.226", "121.255.254.227",
		"121.255.254.228", "121.255.254.229", "121.255.254.230", "121.255.254.231", "121.255.254.232",
		"121.255.254.233", "121.255.254.234", "121.255.254.235", "121.255.254.236", "121.255.254.237",
		"121.255.254.238", "121.255.254.239", "121.255.254.240", "121.255.254.241", "121.255.254.242",
		"121.255.254.243", "121.255.254.244", "121.255.254.245", "121.255.254.246", "121.255.254.247",
		"121.255.254.248", "121.255.254.249", "121.255.254.250", "121.255.254.251", "121.255.254.252",
		"121.255.254.253", "121.255.254.254", "121.255.254.255", "121.255.255.0", "121.255.255.1",
		"121.255.255.2", "121.255.255.3", "121.255.255.4", "121.255.255.5", "121.255.255.6",
		"121.255.255.7", "121.255.255.8", "121.255.255.9", "121.255.255.10", "121.255.255.11",
		"121.255.255.12", "121.255.255.13", "121.255.255.14", "121.255.255.15", "121.255.255.16",
		"121.255.255.17", "121.255.255.18", "121.255.255.19", "121.255.255.20", "121.255.255.21",
		"121.255.255.22", "121.255.255.23", "121.255.255.24", "121.255.255.25", "121.255.255.26",
		"121.255.255.27", "121.255.255.28", "121.255.255.29", "121.255.255.30", "121.255.255.31",
		"121.255.255.32", "121.255.255.33", "121.255.255.34", "121.255.255.35", "121.255.255.36",
		"121.255.255.37", "121.255.255.38", "121.255.255.39", "121.255.255.40", "121.255.255.41",
		"121.255.255.42", "121.255.255.43", "121.255.255.44", "121.255.255.45", "121.255.255.46",
		"121.255.255.47", "121.255.255.48", "121.255.255.49", "121.255.255.50", "121.255.255.51",
		"121.255.255.52", "121.255.255.53", "121.255.255.54", "121.255.255.55", "121.255.255.56",
		"121.255.255.57", "121.255.255.58", "121.255.255.59", "121.255.255.60", "121.255.255.61",
		"121.255.255.62", "121.255.255.63", "121.255.255.64", "121.255.255.65", "121.255.255.66",
		"121.255.255.67", "121.255.255.68", "121.255.255.69", "121.255.255.70", "121.255.255.71",
		"121.255.255.72", "121.255.255.73", "121.255.255.74", "121.255.255.75", "121.255.255.76",
		"121.255.255.77", "121.255.255.78", "121.255.255.79", "121.255.255.80", "121.255.255.81",
		"121.255.255.82", "121.255.255.83", "121.255.255.84", "121.255.255.85", "121.255.255.86",
		"121.255.255.87", "121.255.255.88", "121.255.255.89", "121.255.255.90", "121.255.255.91",
		"121.255.255.92", "121.255.255.93", "121.255.255.94", "121.255.255.95", "121.255.255.96",
		"121.255.255.97", "121.255.255.98", "121.255.255.99", "121.255.255.100", "121.255.255.101",
		"121.255.255.102", "121.255.255.103", "121.255.255.104", "121.255.255.105", "121.255.255.106",
		"121.255.255.107", "121.255.255.108", "121.255.255.109", "121.255.255.110", "121.255.255.111",
		"121.255.255.112", "121.255.255.113", "121.255.255.114", "121.255.255.115", "121.255.255.116",
		"121.255.255.117", "121.255.255.118", "121.255.255.119", "121.255.255.120", "121.255.255.121",
		"121.255.255.122", "121.255.255.123", "121.255.255.124", "121.255.255.125", "121.255.255.126",
		"121.255.255.127", "121.255.255.128", "121.255.255.129", "121.255.255.130", "121.255.255.131",
		"121.255.255.132", "121.255.255.133", "121.255.255.134", "121.255.255.135", "121.255.255.136",
		"121.255.255.137", "121.255.255.138", "121.255.255.139", "121.255.255.140", "121.255.255.141",
		"121.255.255.142", "121.255.255.143", "121.255.255.144", "121.255.255.145", "121.255.255.146",
		"121.255.255.147", "121.255.255.148", "121.255.255.149", "121.255.255.150", "121.255.255.151",
		"121.255.255.152", "121.255.255.153", "121.255.255.154", "121.255.255.155", "121.255.255.156",
		"121.255.255.157", "121.255.255.158", "121.255.255.159", "121.255.255.160", "121.255.255.161",
		"121.255.255.162", "121.255.255.163", "121.255.255.164", "121.255.255.165", "121.255.255.166",
		"121.255.255.167", "121.255.255.168", "121.255.255.169", "121.255.255.170", "121.255.255.171",
		"121.255.255.172", "121.255.255.173", "121.255.255.174", "121.255.255.175", "121.255.255.176",
		"121.255.255.177", "121.255.255.178", "121.255.255.179", "121.255.255.180", "121.255.255.181",
		"121.255.255.182", "121.255.255.183", "121.255.255.184", "121.255.255.185", "121.255.255.186",
		"121.255.255.187", "121.255.255.188", "121.255.255.189", "121.255.255.190", "121.255.255.191",
		"121.255.255.192", "121.255.255.193", "121.255.255.194", "121.255.255.195", "121.255.255.196",
		"121.255.255.197", "121.255.255.198", "121.255.255.199", "121.255.255.200", "121.255.255.201",
		"121.255.255.202", "121.255.255.203", "121.255.255.204", "121.255.255.205", "121.255.255.206",
		"121.255.255.207", "121.255.255.208", "121.255.255.209", "121.255.255.210", "121.255.255.211",
		"121.255.255.212", "121.255.255.213", "121.255.255.214", "121.255.255.215", "121.255.255.216",
		"121.255.255.217", "121.255.255.218", "121.255.255.219", "121.255.255.220", "121.255.255.221",
		"121.255.255.222", "121.255.255.223", "121.255.255.224", "121.255.255.225", "121.255.255.226",
		"121.255.255.227", "121.255.255.228", "121.255.255.229", "121.255.255.230", "121.255.255.231",
		"121.255.255.232", "121.255.255.233", "121.255.255.234", "121.255.255.235", "121.255.255.236",
		"121.255.255.237", "121.255.255.238", "121.255.255.239", "121.255.255.240", "121.255.255.241",
		"121.255.255.242", "121.255.255.243", "121.255.255.244", "121.255.255.245", "121.255.255.246",
		"121.255.255.247", "121.255.255.248", "121.255.255.249", "121.255.255.250", "121.255.255.251",
		"121.255.255.252", "121.255.255.253", "121.255.255.254", "202.111.192.24", "202.111.192.25",
		"202.111.192.26", "202.111.192.27", "202.111.192.28", "202.111.192.29", "202.111.192.30",
		"202.111.192.31", "218.22.22.160", "218.22.22.161", "218.22.22.162", "218.22.22.163",
		"218.22.22.164", "218.22.22.165", "218.22.22.166", "218.22.22.167", "218.22.22.168",
		"218.22.22.169", "218.22.22.170", "218.22.22.171", "218.22.22.172", "218.22.22.173",
		"218.22.22.174", "218.22.22.175", "218.22.22.176", "218.22.22.177", "218.22.22.178",
		"218.22.22.179", "218.22.22.180", "218.22.22.181", "218.22.22.182", "218.22.22.183",
		"218.22.22.184", "218.22.22.185", "218.22.22.186", "218.22.22.187", "218.22.22.188",
		"218.22.22.189", "218.22.22.190", "218.22.22.191", "112.32.50.146"}
	for _, eachItem := range allowedHosts {
		if eachItem == ip {
			return true
		}
	}
	return false
}

// HttpInterceptor 自定义拦截器
func HttpInterceptor() gin.HandlerFunc {
	config.InitLogger("logs/webdict.log", "info")
	return func(c *gin.Context) {
		// 设置 example 变量
		c.Set("example", "12345")
		// 请求前
		addr := remoteAddr(c)
		// ip过滤
		if !isAllowedHost(addr[0]) {
			config.Logger.Warn("Request Refuse:" + addr[0] + ":" + addr[1])
			c.AbortWithStatusJSON(500, gin.H{
				"msg": "非法IP访问",
			})
			return
		}
		//通过请求
		config.Logger.Info("Request Allow:" + addr[0] + ":" + addr[1] + ";" + c.Request.Method + ";" + c.Request.RequestURI)
		c.Next()
	}
}
